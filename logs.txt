
PLAY [Gather facts from CP and Worker nodes] ***********************************

TASK [Gathering Facts] *********************************************************
ok: [eksa-1]
ok: [eksa-0]
ok: [eksa-2]
ok: [eksa-3]
ok: [eksa-4]

TASK [Ensure facts are gathered] ***********************************************
ok: [eksa-4]
ok: [eksa-2]
ok: [eksa-0]
ok: [eksa-1]
ok: [eksa-3]

PLAY [Setup Admin VM for EKS Anywhere] *****************************************

TASK [Gathering Facts] *********************************************************
ok: [eksa-4]

TASK [common : Install common required packages] *******************************
ok: [eksa-4]

TASK [common : Install or upgrade Ansible to required version using pip3] ******
ok: [eksa-4]

TASK [common : Download & Install yq binary] ***********************************
ok: [eksa-4]

TASK [common : Ensure image-builder user exists and is in sudo & kvm groups] ***
ok: [eksa-4]

TASK [common : Generate SSH key for image-builder user] ************************
ok: [eksa-4]

TASK [common : Adjust SSH config to allow ssh-rsa] *****************************
ok: [eksa-4]

TASK [docker : Add Docker's official GPG key] **********************************
ok: [eksa-4]

TASK [docker : Add Docker repository] ******************************************
ok: [eksa-4]

TASK [docker : Install Docker Engine] ******************************************
ok: [eksa-4]

TASK [docker : Add user to docker group] ***************************************
ok: [eksa-4]

TASK [eksa : Check if eksctl exists] *******************************************
ok: [eksa-4]

TASK [eksa : Download eksctl (Linux amd64)] ************************************
skipping: [eksa-4]

TASK [eksa : Extract eksctl binary] ********************************************
skipping: [eksa-4]

TASK [eksa : Move eksctl binary to /usr/local/bin] *****************************
skipping: [eksa-4]

TASK [eksa : Ensure eksctl is executable] **************************************
skipping: [eksa-4]

TASK [eksa : Verify eksctl binary] *********************************************
skipping: [eksa-4]

TASK [eksa : Fail if eksctl binary is not Linux ELF] ***************************
skipping: [eksa-4]

TASK [eksa : Check if eksctl-anywhere exists] **********************************
ok: [eksa-4]

TASK [eksa : Download eksctl-anywhere (Linux amd64)] ***************************
skipping: [eksa-4]

TASK [eksa : Ensure /tmp/eks-a directory exists] *******************************
skipping: [eksa-4]

TASK [eksa : Extract eksctl-anywhere binary] ***********************************
skipping: [eksa-4]

TASK [eksa : Move eksctl-anywhere binary to /usr/local/bin] ********************
skipping: [eksa-4]

TASK [eksa : Ensure eksctl-anywhere is executable] *****************************
skipping: [eksa-4]

TASK [eksa : Verify eksctl-anywhere binary] ************************************
skipping: [eksa-4]

TASK [eksa : Fail if binary is not Linux ELF] **********************************
skipping: [eksa-4]

TASK [eksa : Install rsync on remote machine] **********************************
ok: [eksa-4]

TASK [eksa : Generate hardware.csv] ********************************************
changed: [eksa-4]

TASK [eksa : Ensure remote image directory exists] *****************************
ok: [eksa-4]

TASK [eksa : Copy built image to remote machine with progress] *****************
ok: [eksa-4]

TASK [eksa : Start Python HTTP server to serve the image] **********************
changed: [eksa-4]

TASK [eksa : Read SSH public key] **********************************************
ok: [eksa-4]

TASK [eksa : Generate cluster.yaml] ********************************************
ok: [eksa-4]

TASK [eksa : Create EKS-A cluster] *********************************************
fatal: [eksa-4]: FAILED! => {"changed": true, "cmd": ["eksctl", "anywhere", "create", "cluster", "-f", "/tmp/cluster.yaml", "--hardware-csv", "/tmp/hardware.csv"], "delta": "0:07:39.027880", "end": "2025-08-25 18:49:07.538526", "msg": "non-zero return code", "rc": 255, "start": "2025-08-25 18:41:28.510646", "stderr": "Error: applying cluster spec: applying object with kubectl: The TinkerbellTemplateConfig \"mgmt\" is invalid: spec.template.tasks: Invalid value: \"null\": spec.template.tasks in body must be of type array: \"null\"", "stderr_lines": ["Error: applying cluster spec: applying object with kubectl: The TinkerbellTemplateConfig \"mgmt\" is invalid: spec.template.tasks: Invalid value: \"null\": spec.template.tasks in body must be of type array: \"null\""], "stdout": "Performing setup and validations\n✅ Tinkerbell Provider setup is valid\n✅ Validate OS is compatible with registry mirror configuration\n✅ Validate certificate for registry mirror\n✅ Validate authentication for git provider\n✅ Validate cluster's eksaVersion matches EKS-A version\n✅ Validate extended kubernetes version support is supported\nCreating new bootstrap cluster\nProvider specific pre-capi-install-setup on bootstrap cluster\nInstalling cluster-api providers on bootstrap cluster\nProvider specific post-setup\nInstalling EKS-A custom components on bootstrap cluster\nInstalling EKS-D components\nInstalling EKS-A custom components (CRD and controller)\nCreating new management cluster\ncollecting management cluster diagnostics\n⏳ Collecting support bundle from cluster, this can take a while\t{\"cluster\": \"bootstrap-cluster\", \"bundle\": \"mgmt/generated/bootstrap-cluster-2025-08-25T18:48:34Z-bundle.yaml\", \"since\": 1756136914437565284, \"kubeconfig\": \"mgmt/generated/mgmt.kind.kubeconfig\"}\nSupport bundle archive created\t{\"path\": \"support-bundle-2025-08-25T18_48_36.tar.gz\"}\nAnalyzing support bundle\t{\"bundle\": \"mgmt/generated/bootstrap-cluster-2025-08-25T18:48:34Z-bundle.yaml\", \"archive\": \"support-bundle-2025-08-25T18_48_36.tar.gz\"}\nAnalysis output generated\t{\"path\": \"mgmt/generated/bootstrap-cluster-2025-08-25T18:49:01Z-analysis.yaml\"}", "stdout_lines": ["Performing setup and validations", "✅ Tinkerbell Provider setup is valid", "✅ Validate OS is compatible with registry mirror configuration", "✅ Validate certificate for registry mirror", "✅ Validate authentication for git provider", "✅ Validate cluster's eksaVersion matches EKS-A version", "✅ Validate extended kubernetes version support is supported", "Creating new bootstrap cluster", "Provider specific pre-capi-install-setup on bootstrap cluster", "Installing cluster-api providers on bootstrap cluster", "Provider specific post-setup", "Installing EKS-A custom components on bootstrap cluster", "Installing EKS-D components", "Installing EKS-A custom components (CRD and controller)", "Creating new management cluster", "collecting management cluster diagnostics", "⏳ Collecting support bundle from cluster, this can take a while\t{\"cluster\": \"bootstrap-cluster\", \"bundle\": \"mgmt/generated/bootstrap-cluster-2025-08-25T18:48:34Z-bundle.yaml\", \"since\": 1756136914437565284, \"kubeconfig\": \"mgmt/generated/mgmt.kind.kubeconfig\"}", "Support bundle archive created\t{\"path\": \"support-bundle-2025-08-25T18_48_36.tar.gz\"}", "Analyzing support bundle\t{\"bundle\": \"mgmt/generated/bootstrap-cluster-2025-08-25T18:48:34Z-bundle.yaml\", \"archive\": \"support-bundle-2025-08-25T18_48_36.tar.gz\"}", "Analysis output generated\t{\"path\": \"mgmt/generated/bootstrap-cluster-2025-08-25T18:49:01Z-analysis.yaml\"}"]}

PLAY RECAP *********************************************************************
eksa-0                     : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
eksa-1                     : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
eksa-2                     : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
eksa-3                     : ok=2    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
eksa-4                     : ok=22   changed=2    unreachable=0    failed=1    skipped=13   rescued=0    ignored=0   

